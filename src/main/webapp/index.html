<!DOCTYPE HTML>
<html lang="en" ng-app="JamStash" ng-controller="AppController">
<head>
<meta http-equiv="Content-type" content="text/html; charset=UTF-8">
<meta name="description"
	content="Kalimba Radio, CHANGING THE WAY AFRICA LISTENS TO MUSIC ">
<meta name="keywords"
	content="Kalimba KalimbaRadio, African Music, Zambia, Music Streaming, Zambian Music, Africa, ZED, Pilato,dandy krazy,Kolopa,Slap Dee,Macky 2,Zed beats,Free Zed music,Zambian music,DJ Mzengaman,Kalimba">
<meta property="og:image"
	content="http://jamstash.com/images/fbpreview.png" />
<meta name=viewport content="width=device-width, initial-scale=1">
<title ng-bind="Page.title()">Kalimba Radio</title>
<script type="text/javascript">
if (screen.width <= 699) {
document.location = "http://m.kalimbaradio.com";
}
</script>

<link href="images/favicon_webplayer.ico" rel="shortcut icon" />
<link rel="icon" href="images/favicon_webplayer.png" sizes="48x48" />
<link rel="icon" href="images/favicon_webplayer.png" sizes="32x32" />
<link href="assets/css/template.css" rel="stylesheet">

<!-- build:css(.) styles/vendor.min.css -->
<!-- bower:css -->
<link rel="stylesheet"
	href="bower_components/fancybox/source/jquery.fancybox.css" />
<!-- endbower -->
<!-- endbuild -->
<link href="styles/Style.css" rel="stylesheet" type="text/css"
	data-name="main" />
<link href="styles/Mobile.css" rel="stylesheet" type="text/css"
	data-name="main" />
<link href="" rel="stylesheet" type="text/css" data-name="theme" />
<style>
.tiptext {
	background: #FFFFFF;
	border: 1px #333;
	padding: 5px;
	width: auto;
	height: auto;
	color: 5B5B4E;
	right: 310px;
	top: 10px;
}

.description {
	margin-top: 36px;
	display: none;
	position: absolute;
	border: 1px solid green;
	min-width: 500px;
	height: auto;
	z-index: 1;
	background-color: #FFFFFF;
	margin-left: -200px;
}

.overlay {
	visibility: hidden;
	position: absolute;
	left: 0px;
	top: 0px;
	width: 100%;
	height: 100%;
	text-align: center;
	z-index: 1000;
	display: none;
}
.loading { border:1px solid #ddd; padding:20px; margin:40px 5px; width:80px;}

.boxshadow {
	-moz-box-shadow: 3px 3px 5px #535353;
	-webkit-box-shadow: 3px 3px 5px #535353;
	box-shadow: 3px 3px 5px #535353;
}

.roundbox {
	-moz-border-radius: 6px 6px 6px 6px;
	-webkit-border-radius: 6px;
	border-radius: 6px 6px 6px 6px;
}
</style>

</head>
<body
	ui-keypress="{'32 179': 'togglePause($event)', '43 61 187': 'turnVolumeUp($event)', '45 95 189': 'turnVolumeDown($event)'}"
	ui-keydown="{'right 176': 'nextTrack($event)', 'left 177': 'previousTrack($event)'}">
	<form action="" method="post">
		<!-- End container -->
		<input type="hidden" name="name" /> <input type="hidden" name="email" />
		<input type="hidden" name="first_name" /> <input type="hidden"
			name="last_name" /> <input type="hidden" name="gender" /> <input
			type="hidden" name="birthday" /> <input type="hidden"
			name="location" /> <input type="hidden" name="hometown" /> <input
			type="hidden" name="relationship" /> <input type="hidden"
			name="timezone" /> <input type="hidden" name="sessionEmail" /> <input
			type="hidden" name="killSession" /> <input type="hidden"
			name="userType" value="" /> <input type="hidden" name="providerId"
			value="" />

		<div id="fb-root"></div>
			
			 <script>
			    window.onload = function () { 
				    			 
				 var tokenId=get('tnsId');
				 var PnrID=get('PnrID');
				// var CCDapproval=get('CCDapproval');
				// var CompanyRef=get('CompanyRef');	
				 if(tokenId !==undefined && PnrID !==undefined)
				 {
					 $(document).ready(function() {
						    $.ajax({
						        url: "http://www.kalimbaradio.com/getDownloadValidation?PnrID="+PnrID+"&tnsId="+tokenId
						    }).then(function(data) {
						       alert(data);
						       if(data==='success')
						    	   {
						    	   downloadSong();
									setTimeout(function(){},200000);
						    	   }
						    });
						});
					
				//	saveTranscationDetails(tokenId,PnrID,CCDapproval,CompanyRef);
					 }
				       
				 				
	          }
			 
  
		 function get(name){
		
			 if(name=(new RegExp('[?&]'+encodeURIComponent(name)+'=([^&]*)')).exec(location.search))
			 return decodeURIComponent(name[1]);
			 }

     function downloadSong(){
    	 var scopeCart = angular.element(document.getElementById("template/ngCart/addtocart.html")).scope();
		 //setTimeout(function(){alert(scopeCart.token)},50000);			 
		 var scopeMain = angular.element(document.getElementById("loginElement")).scope();
		 scopeCart.$apply(function() {			
			 var items=  scopeCart.ngCart.getItemId();
			 var i=0;
			 angular.forEach(items, function (item) {
		    		var id=item.getId();
		    		//alert(id);
		    		scopeMain.download(id, i);
		    		i++;
		         }); 
			 scopeCart.ngCart.empty();			
		
		 });       
         }

/* function saveTranscationDetails(tokenId,PnrID,CCDapproval,CompanyRef){
	// document.forms[0].method = 'post';	
	 document.forms[0].action = 'getTransaction?TransID='+tokenId+'&PnrID='+PnrID+'&CCDapproval='+CCDapproval+'&CompanyRef='+CompanyRef;
	document.forms[0].submit();	
} */

		 
			</script>
		<script>
			(function(d, s, id) {
				var js, fjs = d.getElementsByTagName(s)[0];
				if (d.getElementById(id))
					return;
				js = d.createElement(s);
				js.id = id;
				js.src = "//connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v2.0&appId=257684847772401";
				fjs.parentNode.insertBefore(js, fjs);
			}(document, 'script', 'facebook-jssdk'));
		</script>

		<script>
			/*(function (i, s, o, g, r, a, m) {
			    i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
			        (i[r].q = i[r].q || []).push(arguments)
			    }, i[r].l = 1 * new Date(); a = s.createElement(o),
			m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
			})(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

			ga('create', 'UA-58557800-2', 'KalimbaWebPlayer');
			ga('send', 'pageview');*/

			(function(i, s, o, g, r, a, m) {
				i['GoogleAnalyticsObject'] = r;
				i[r] = i[r] || function() {
					(i[r].q = i[r].q || []).push(arguments)
				}, i[r].l = 1 * new Date();
				a = s.createElement(o), m = s.getElementsByTagName(o)[0];
				a.async = 1;
				a.src = g;
				m.parentNode.insertBefore(a, m)
			})(window, document, 'script',
					'//www.google-analytics.com/analytics.js', 'ga');

			ga('create', 'UA-58557800-2', 'KalimbaWebPlayer');
			ga('send', 'pageview');

			function checkLoginState(userType) {
				//var var1=$scope.var1;
			//	alert(var1);
				//alert("userType=" + userType);
				FB.login(function(response) {
					statusChangeCallback(response, userType);

				});
				$("#dialog-user").dialog("close");
				$("#dialog-artist").dialog("close");
			}

			function statusChangeCallback(response, userType) {
			/* 	var var1=$scope.var1;
				alert(var1); */
				console.log('statusChangeCallback');
				console.log(response);
				console.log(userType);
				// The response object is returned with a status field that lets the
				// app know the current login status of the person.
				// Full docs on the response object can be found in the documentation
				// for FB.getLoginStatus().
				if (response.status === 'connected') {
					// Logged into your app and Facebook.
					testAPI(userType);
				} else if (response.status === 'not_authorized') {
					// The person is logged into Facebook, but not your app.
					console.log('Please log into this app.');
				} else {
					// The person is not logged into Facebook, so we're not sure if
					// they are logged into this app or not.
					console.log('Please log into Facebook.');
				}
			}

			
			window.fbAsyncInit = function() {
				FB.init({
					appId : '257684847772401',
					cookie : true, // enable cookies to allow the server to access 
					// the session
					xfbml : true, // parse social plugins on this page
					version : 'v2.0' // use version 2.0
				});

				// Now that we've initialized the JavaScript SDK, we call 
				// FB.getLoginStatus().  This function gets the state of the
				// person visiting this page and can return one of three states to
				// the callback you provide.  They can be:
				//
				// 1. Logged into your app ('connected')
				// 2. Logged into Facebook, but not your app ('not_authorized')
				// 3. Not logged into Facebook and can't tell if they are logged into
				//    your app or not.
				//
				// These three cases are handled in the callback function.

				//alert("check param" + userType);
				FB
						.getLoginStatus(function(response) {
							if (response.status === 'connected') {
							
							FB
									.api(
											"/me/picture?width=55&height=55",
											function(response) {
												
												

												console.log("url"
														+ response.data.url);

												document
														.getElementById('sslogo').style.display = "block";
												document
														.getElementById('sslogo').innerHTML = "<img style='webkit-border-radius: 55; -moz-border-radius: 55;  border-radius: 55px;' src="+response.data.url +">";

												//document.getElementById('ssname').style.display = "block";
												//document.getElementById('ssname').innerHTML = {{user.name}};

												console.log("the end");

												//document.forms[0].action="/U";
												

											});

							}			

						});

				FB
						.getLoginStatus(function(response) {
							
							if (response.status === 'connected') {
							FB
									.api(
											'/me',
											function(response) {
												
												

											//	console.log(response.data.url);

												 if (typeof response.name != 'undefined') {
													document
															.getElementById('ssname').style.display = "block";
													document
															.getElementById('ssname').innerHTML = response.first_name;
												} 
												console.log("the end");

												//document.forms[0].action="/U";
												var scope = angular
												.element(
														document
																.getElementById("loginElement"))
												.scope();
										scope.$apply(function() {
											scope.saveUser(response);
											//scope.saveUser(response);
										});

												
											
								}	);
									
							}
						});

			};

			// Load the SDK asynchronously
			(function(d, s, id) {
				var js, fjs = d.getElementsByTagName(s)[0];
				if (d.getElementById(id))
					return;
				js = d.createElement(s);
				js.id = id;
				js.src = "//connect.facebook.net/en_US/sdk.js";
				fjs.parentNode.insertBefore(js, fjs);
			}(document, 'script', 'facebook-jssdk'));

			// Here we run a very simple test of the Graph API after login is
			// successful.  See statusChangeCallback() for when this call is made.

			function testAPI(userType) {
				//var var1=$scope.var1;

				console.log('Welcome!  Fetching your information.... ');

				FB
						.api(
								"/me/picture?width=55&height=55",
								function(response) {

									console.log("url" + response.data.url);

									document.getElementById('sslogo').style.display = "block";
									document.getElementById('sslogo').innerHTML = "<img style ='webkit-border-radius: 55; -moz-border-radius: 55;  border-radius: 55px;' src="+response.data.url +">";

									console.log("the end");

									//document.forms[0].action="/U";

								});

				FB
						.api(
								'/me',
								function(response) {
									//console.log('Successful login for: '
									//		+ response.name);
									console.log('Successful login for: '
											+ JSON.stringify(response));
									//alert(JSON.stringify(response));
									// document.getElementById('status').innerHTML =
									//   'Thanks for logging in, ' + response.name + '!';

									//alert(document.forms[0].getElementsByName("name").value);
									//alert(document.forms[0].getElementById("name").value);
									//alert(document.getElementById("name").value);
									//alert(response.name);
									if (typeof response.first_name != 'undefined') {
										document.getElementById('ssname').style.display = "block";
										document.getElementById('ssname').innerHTML = response.first_name;
									}
									document.forms[0].name.value = response.name;
									//alert(document.forms[0].name.value);
									document.forms[0].email.value = response.email;
									document.forms[0].first_name.value = response.first_name;
									document.forms[0].last_name.value = response.last_name;
									document.forms[0].gender.value = response.gender;
									document.forms[0].birthday.value = ''; //response.birthday;

									document.forms[0].location.value = response.location ? response.location.name
											: '';
									document.forms[0].hometown.value = response.hometown ? response.hometown.name
											: '';
									//document.forms[0].bio.value = response.bio;
									document.forms[0].relationship.value = response.relationship_status;
									document.forms[0].timezone.value = response.timezone;
									document.forms[0].userType.value = userType;
									document.forms[0].providerId.value = "1";
									document.forms[0].sessionEmail.value = response.email;
									//response.id;
									document.getElementById('ssname').style.display = "block";
									document.getElementById('ssname').innerHTML = response.first_name;
									
									var scope = angular
											.element(
													document
															.getElementById("loginElement"))
											.scope();
									scope.$apply(function() {
										scope.saveUser(response);
										//scope.saveUser(response);
									});
									//saveUser(response);
									//alert(document.forms[0].location.value);
									//alert(document.forms[0].hometown.value);
									//alert(document.forms[0].relationship.value);
									//alert(document.forms[0].timezone.value);
									callServlet();

								});
			}

			function callServlet() {
				if (document.forms[0].email.value != '') {
					// Logged into your app and Facebook.
					//alert("call servlet");
					sessionEmail = document.forms[0].sessionEmail.value;
					//if (sessionEmail == "") {
					document.forms[0].method = 'post';

					document.forms[0].action = 'saveUser';

					document.forms[0].submit();
					

				}
			}

			function callLogout() {
				//alert("in logout");
				/*FB.logout(function(response) {
					  // user is now logged out
					//document.location.reload();
					FB.Auth.setAuthResponse(null, 'unknown');
					document.forms[0].sessionEmail.value="";
					//document.getElementById('dialog-link').style.display = "block";
					//document.getElementById('dialog-link').innerHTML = "<img src='${pageContext.request.contextPath}/resources/IMAGES/ART BUTTON OVER.png'>";

					});
				document.forms[0].sessionEmail.value="";*/
				document.forms[0].sessionEmail.value = "";
				document.forms[0].killSession.value = "Y";
				//alert(FB);
				if (FB == 'undefined') {
					FB.getLoginStatus(function(response) {
						if (response && response.status === 'connected') {

							FB.logout(function(response) {
								//document.location.reload();

							});
						}
					});
				}
				document.forms[0].action = "index.jsp";
				document.forms[0].submit();
			}
			
			function showCart(id, value) {
				 $(this).children(".description").show();
			}
		</script>
		<!-- build:js({.,app}) scripts/vendor.min.js -->
		<!-- bower:js -->
		<script src="bower_components/jquery/jquery.js"></script>
		<script src="bower_components/angular/angular.js"></script>
		<script src="bower_components/angular-route/angular-route.js"></script>
		<script src="bower_components/angular-sanitize/angular-sanitize.js"></script>
		<script src="bower_components/angular-cookies/angular-cookies.js"></script>
		<script src="bower_components/angular-resource/angular-resource.js"></script>
		<script src="bower_components/jquery-ui/ui/jquery-ui.js"></script>
		<script src="bower_components/jplayer/dist/jplayer/jquery.jplayer.js"></script>
		<script src="bower_components/fancybox/source/jquery.fancybox.js"></script>
		<script src="bower_components/notify.js/notify.js"></script>
		<script src="bower_components/jquery.scrollTo/jquery.scrollTo.js"></script>
		<script src="bower_components/underscore/underscore.js"></script>
		<script
			src="bower_components/angular-underscore/angular-underscore.js"></script>
		<script
			src="bower_components/angular-locker/dist/angular-locker.min.js"></script>
		<script src="bower_components/angular-ui-utils/keypress.js"></script>
		<script src="bower_components/ngcart/dist/ngCart.js"></script>
		
		<!-- <script src="bower_components/angular-ui-router/release/angular-ui-router.js"></script>
		<script src="bower_components/angular-ui-router/release/angular-ui-router.min.js"></script> -->
		
		
		
		<script  src="http://fgnass.github.io/spin.js/spin.min.js"></script>
		<!-- endbower -->
		<script src="vendor/jquery.base64.js"></script>
		<script src="vendor/jquery.dateFormat-1.0.js"></script>
		<!-- endbuild -->
		<!-- our scripts -->
		<!-- build:js(app) scripts/scripts.min.js -->
		<script src=" app.js"></script>
		<script src="settings/settings.js"></script>
		<script src="settings/settings-service.js"></script>
		<script src="common/model-service.js"></script>
		<script src="common/utils-service.js"></script>
		<script src="common/page-service.js"></script>
		<script src="common/notification-service.js"></script>
		<script src="common/persistence-service.js"></script>
		<script src="common/main-controller.js"></script>
		<script src="subsonic/subsonic.js"></script>
		<script src="subsonic/subsonic-service.js"></script>
		<script src="archive/archive.js"></script>
		<script src="archive/archive-service.js"></script>
		<script src="player/player.js"></script>
		<script src="player/player-directive.js"></script>
		<script src="player/player-service.js"></script>
		<script src="queue/queue.js"></script>
		<script src="common/filters.js"></script>
		<script src="common/directives.js"></script>
		
		<!-- top navi -->
    <script type="text/javascript" src="assets/js/bootstrap-3.1.1.min.js"></script>
    <script type="text/javascript" src="assets/js/jquery.isotope.min.js?v=1.5.26"></script>
    <script type="text/javascript" src="assets/js/jquery.singlePageNav.min.js"></script>
    <script type="text/javascript" src="assets/js/main.js"></script>
		<!-- endbuild -->
		<div id="container">
		 <!-- 	<div id="header">
				<div id="messages">
					<span ng-attr-id="{{ 'msg_' + $index }}" class="message"
						ng-repeat="item in Messages track by $index" ng-bind-html="item"></span>
				</div>
				<div id="loading"></div>
				<a id="jslogo" title="Kalimba Radio" class="showQueue" href=""></a>

				
				<a target="_blank" class="Main-Menu" title="About Us"  href="https://www.kalimbaradio.com/about">About Us</a>
				
				<fb:login-button id="sslogo" size="medium" scope="email"
					onlogin="checkLoginState('U');"></fb:login-button>
				<div id="ssname" href=""></div>
				
				<div align="right" class="tiptext cartstyle" style="color: 5B5B4E"
					id="testid">
					<div class="description boxshadow" id="dialogtest">
						<div id="loginElement"></div>
						<ngcart-cart></ngcart-cart>
				
					</div>
					<ngcart-summary></ngcart-summary>

				</div>


				
			</div>-->
			 <header id="header" class="site-header">
        <nav id="topbar" class="site-topbar visible-lg visible-md">
          <div class="">
            <div class="row">
              <div class="col-sm-6">&nbsp;&nbsp;Questions? Email us at:<a href="mailto:info@kalimbaradio.com">info@kalimbaradio.com</a></div>
              <div class="social-links col-sm-6">
                <a target="_blank" href="https://www.facebook.com/kalimbamedia"><i class="fa fa-facebook"></i></a>
                <a target="_blank" href="https://twitter.com/KalimbaMedia"><i class="fa fa-twitter"></i></a>
                <a target="_blank" href="http://goo.gl/UKiiBU"><img src="images/android.png"  alt="Kalimba Radio Free African music streaming"></a> 
                <a target="_blank" href="http://goo.gl/TxGX2C"><img src="images/blackberryicon.png"  alt="Kalimba Radio Free African music streaming"></a>
                &nbsp; <!-- <font color="39b54a">0 Items &nbsp;&nbsp;</font> -->
              </div>
            </div>
          </div>
        </nav>

        <nav id="navbar" class="site-navbar navbar navbar-static-top" role="navigation">
          <div class="">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <i class="fa fa-bars"></i>
              </button>
              <h1 class="navbar-brand"><a href="index.html"><img src="images/kalimba_logo-01.png"  alt="Kalimba Radio Free African music streaming"></a></h1>
            </div>
            <div align="right" class="tiptext cartstyle"  style="color: 5B5B4E"
					id="testid">
					<div class="description boxshadow" id="dialogtest">
						<div id="loginElement"></div>
						<ngcart-cart></ngcart-cart>
				
					</div>
					<ngcart-summary></ngcart-summary>

				</div>
				<div id="spinner" class="spinner" style="display:none;">
    <img id="img-spinner" src="images/ajax_loader_gray_128.gif" style="width:128px;height:128px;margin-top:15%;" alt="Loading"/>
</div>
            <div class="collapse navbar-collapse" id="navbar-collapse-1">
              <ul id="navigation" class="nav navbar-nav navbar-right">
                 <li style="width: 60px;top: 3px;"><fb:login-button id="sslogo" size="medium" scope="email"
					onlogin="checkLoginState('U');"></fb:login-button>
					<div id="ssname" href=""></div></li>
                 <li><a target="_blank" href="http://www.kalimbaradio.com/about/">About Us</a></li>
                <li><a target="_blank" href="http://blog.kalimbaradio.com">Blog</a></li>
                <li><a target="_blank" href="http://www.kalimbaradio.com/about/#contact">Contact Us &nbsp;&nbsp;</a></li>

              </ul>
            </div>
          </div>
        </nav>
      </header>
			
			<div id="content">
				<!-- Main -->
				<div ng-view=""></div>
				<!-- Audio Player -->
				<div class="clear"></div>

				<div class="clear"></div>
			</div>
			<!-- end #content -->
			<div id="SideBar" class="boxshadow" ng-include=""
				src="'queue/queue.html'" ng-controller="QueueController">
				<!--
            <div id="NowPlaying">
                <div class="header"><img src="images/rss_12x12.png" /> Now Playing</div>
                <div id="NowPlayingList"><span class="user">Loading...</span></div>
            </div>
            <div id="Chat">
                <div class="header"><img src="images/chat_alt_stroke_12x12.png" /> Chat</div>
                <div id="ChatMsgs"></div>
            </div>
            <div class="submit"><img src="images/comment_stroke_gl_12x11.png" /><input type="text" id="ChatMsg" class="chat" title="Hit [Enter] to Post" /></div>
            -->
			</div>
			<!-- <div id="SideBar-Ads"> -->
			<!--  <div class="center">
								<a href="https://www.ticketriver.com/event/17427" target="_blank" title="KalimbaRadio Presents OC Osilliation"><img class="tr-event-img" alt="Event's image" src="https://d1d6g07qo35lq3.cloudfront.net/images/event/17427/event447287.JPG"></a>
							
			<link rel="stylesheet" type="text/css" href="https://www.ticketriver.com/styles/widget.css"/> <div class="ticketriver"><a href="https://www.ticketriver.com/event/17427" target="_blank" title="KalimbaRadio Presents OC Osilliation"><img src="https://www.ticketriver.com/images/BuyTicketsButton_orange.gif" border="0"/></a></div><img src="https://www.ticketriver.com/eventWidgetBeacon?id=MTc0Mjc=" style="display:none;"/>
			</div>-->
			<!-- <div class="center"><a href="http://feeds.feedburner.com/kalimbaradio/fAWO" title="Subscribe to my feed" rel="alternate" type="application/rss+xml"><img src="//feedburner.google.com/fb/images/pub/feed-icon32x32.png" alt="" style="border:0"/></a><a href="http://feeds.feedburner.com/kalimbaradio/fAWO" title="Subscribe to my feed" rel="alternate" type="application/rss+xml">Subscribe in a reader</a></div>
			<div class="center">
			  <div class="ticketriver"><a href="https://www.gofundme.com/mandelaoverlook" target="_blank" title="Build a Nelson Mandela Memorial"><img src="http://s14.postimg.org/mg9775za9/aaa_300x250_2.jpg" border="0"/></a></div>
			</div> -->
			<!-- <img src="images/Ads250X200.png"/> -->
			<!-- <script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
Kalimba_top
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-1661599498798804"
     data-ad-slot="6314169376"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script> -->
			
			<!-- </div> -->
			<!-- Player -->
			<div ng-include="" src="'player/player.html'"
				ng-controller="PlayerController"></div>
		</div>
	</form>
</body>
</html>
